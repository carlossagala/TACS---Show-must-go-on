<main class="scene">
  <div class="actor">
    <div class="actor__prefix">-</div>
    <div id="vader"></div>
  </div>

  <div class="actor">
    <div class="actor__prefix">-</div>
    <div id="luke"></div>
  </div>
</main>

<script src="https://cdn.jsdelivr.net/theaterjs/latest/theater.min.js"></script>
<script>
  /*
 * TheaterJS, a typing effect mimicking human behavior.
 *
 * Github repository: 
 * https://github.com/Zhouzi/TheaterJS
 *
 */

var theater = theaterJS()

theater
  .on('type:start, erase:start', function () {
    theater.getCurrentActor().$element.classList.add('actor__content--typing')
  })
  .on('type:end, erase:end', function () {
    theater.getCurrentActor().$element.classList.remove('actor__content--typing')
  })
  .on('type:start, erase:start', function () {
    if (theater.getCurrentActor().name === 'vader') {
      document.getElementsByClassName('scene')[0].classList.add('dark')
    } else {
      document.getElementsByClassName('scene')[0].classList.remove('dark')
    }
  })

  var talking = function() {

		theater
		  .addActor('vader', { speed: 0.8, accuracy: 0.6 })
		  .addActor('luke')
		  .addScene('vader:Luke.', 600)
		  .addScene('luke:What?', 400)
		  .addScene('vader:I am your father.', 400)
		  .addScene('luke:Nooo...', -3, '!!! ', 600, 'No! ', 600)
		  .addScene('luke:That\'s not true!', 600)
		  .addScene('luke:That\'s impossible!', 400)
		  .addScene('vader:Search your feelings.', 1600)
		  .addScene('vader:You know it to be true.', 1000)
		  .addScene('luke:Noooooooo! ', 600, 'No!', 400)
		  .addScene('vader:Luke.', 600)
		  .addScene('vader:You can destroy the Emperor.', 1600)
		  .addScene('vader:He has foreseen this. ', 800)
		  .addScene('vader:It is your destiny.', 1600)
		  .addScene('vader:Join me.', 800)
		  .addScene('vader:Together we can rule the galaxy.', 800)
		  .addScene('vader:As father and son.', 1600)
		  .addScene('vader:Come with me. ', 800)
		  .addScene('vader:It is the only way.', 2000)
		  .addScene(theater.replay.bind(theater))
  }


  $("#startTalking").on("click", function(){

  	if($(this).data('status') === 'inactive') {
	  	$("#panelLeft").removeClass("hide");
	  	$("#panelRight").removeClass("s12").addClass("s9");
	  	$(this).data('status', 'active');
	  	$(this).text("Stop talking");

	  	talking();
	  	theater.play();
  	}
  	else {

  		theater.stop();

  		$("#panelLeft").addClass("hide");
	  	$("#panelRight").addClass("s12").removeClass("s9");
  		$(this).data('status', 'inactive')
  		$(this).text("Start talking...");
  		
  	}

  })

</script>